<!doctype html>
<html lang="en">
<head>
    <title>d3 data viz tutorial</title>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.0/d3.min.js"></script>
</head>
<body>
<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>
<script>
    // Create an SVG
    var svg = d3.select("#my_dataviz")
        .append("svg")
        .attr("width", 500)
        .attr("height", 400);

    var data = [
        {"country":"US", "value1": 100, "value2": 50},
        {"country":"UK", "value1": 30, "value2": 20},
        {"country":"Germany", "value1": 40, "value2": 30},
        {"country":"France", "value1": 20, "value2": 10}
    ];

    // Get the columns.
    var values = d3.keys(data[0])
        .slice(1);

    // Create a select element
    var select = d3.select("body")
        .append("select")
        .on("change", update)

    // Add an initial option:
    select.append("option")
        .html("Select Value:")

    // Add the options:
    var options = select.selectAll(null)
        .data(values)
        .enter()
        .append("option")
        .text(function(d) { return d; });


    // Spice it up with some scales:
    var x = d3.scaleBand()
        .domain(data.map(function(d) { return d.country; }))
        .range([0,500])

    var y = d3.scaleLinear()
        .domain([0,100])
        .range([150,0])


    // Specify an Update function to create and update visualization elements:
    function update() {
        var value = this.value;
        var bars = svg.selectAll("rect")
            .data(data);

        bars.enter().append("rect")
            .attr("x", function(d) { return x(d.country); })
            .attr("width", x.bandwidth())
            .attr("y", 150)
            .attr("height",0)
            .merge(bars)
            .transition()
            .attr("height", function(d) { return 150 - y(d[value] || 0); })
            .attr("y", function(d) { return y(d[value] || 0); });

    }

</script>
</body>
</html>