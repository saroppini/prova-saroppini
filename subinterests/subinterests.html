<!DOCTYPE html>
<html lang="eng">
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <title>persons non Ã¨ un errore</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datasource@0.1.0"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.min.js"></script>

    <style>
        div#container {
            height: 200px;
            width: 800px;
            margin: auto;
        }
        body {
            font-family: 'Roboto';
            color: #333;
            background-color: #F9F7EB;
        }
        .butt{
            justify-content: center;
            text-align: center;
            margin: auto;
        }
        .button{
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 10px 28px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
        }
        .button1 {
            background-color: white;
            color: black;
            border: 2px solid #555555;
        }

        .button1:hover {
            background-color: #555555;
            color: white;
        }
        #title {
            font-family: 'Merriweather';
            text-align: center;
            padding: 30px;
            font-size: 28px;
            letter-spacing: -0.01em;
            color: #333;
        }
        #legend {
            display: flex;
            justify-content: center;
            padding: 0 10px 10px 10px;
            font-size: 14px;
        }
        #legend .item {
            line-height: 12px;
            padding: 0 10px 0 4px;
        }

        #legend .item.one {
            border-left: 12px solid #d4ebf2;
        }
        #legend .item.two {
            border-left: 12px solid;
        }
        #legend .item.three {
            border-left: 12px solid #add3e6;
        }
        #legend .item.four {
            border-left: 12px solid #add8e6;
        }
        #legend .item.five {
            border-left: 12px solid #addde6;
        }
        #legend .item.six {
            border-left: 12px solid #ade2e6;
        }
        #legend .item.seven {
            border-left: 12px solid #ade6e6;
        }
    </style>
</head>
<body>

<!-- <div id="legend">
  <div class="item one">1</div>
  <div class="item two">2</div>
  <div class="item three">3</div>
  <div class="item four">4</div>
  <div class="item five">6</div>
  <div class="item six">8</div>
  <div class="item seven">15</div>
</div> -->

<div class="butt">
    <button class="button button1" onclick="doit('bar_person_subtype.csv')">People</button>
</div>

<div class="butt">
    <button class="button button1" onclick="doit('chart_to_quest.csv')">Technique/genre/material</button>
</div>

<div id="container">
    <canvas id="chart"></canvas>
</div>


<script>

    function doit(csvpath) {
        const cic = document.getElementById("chart").getContext("2d");

        d3.csv(csvpath, function makeChart(data) {
            // data is an array of objects where each object represents a country
            var subtypes = data.map(function (d) {
                return d.subtype;
            });
            var count = data.map(function (d) {
                return d.count_coll;
            });

            const arrayOfObj = subtypes.map(function (d, i) {
                return {
                    label: d,
                    data: count[i] || 0,
                }
            })

            const sortedArrayOfObj = arrayOfObj.sort(function (a, b) {
                return b.data - a.data
            })

            let newArrayLabel = []
            let newArrayData = []
            sortedArrayOfObj.forEach(function (d) {
                newArrayLabel.push(d.label)
                newArrayData.push(d.data)
            })


            new Chart(cic, {
                type: "bar",
                options: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Number of of people studied by their profession'
                    },
                    scales: {
                        yAxes: [
                            {
                                ticks: {
                                    beginAtZero: true
                                }
                            }
                        ]
                    }
                },
                data: {
                    labels: newArrayLabel,
                    datasets: [
                        {
                            label: "number",
                            data: newArrayData,
                            backgroundColor: ["#cc33ff","#c560e6","#c67cdf","#cb91de","#d8b5e3","#dfc5e7","#cdabd8","#b79bbf","#a69fa8","#8f8f8f"]
                        }
                    ]
                }
            });
        })
    }
</script>

</body>
</html>